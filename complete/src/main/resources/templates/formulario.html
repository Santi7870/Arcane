<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${personaje.id} ? 'Editar Personaje' : 'Nuevo Personaje'"></title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    form div { margin: 10px 0; }
    label { display: inline-block; width: 120px; }
  </style>
</head>
<body>
<h1 th:text="${personaje.id} ? 'Editar Personaje' : 'Nuevo Personaje'"></h1>

<form action="/personajes/guardar" method="post">
  <input type="hidden" name="id" th:value="${personaje.id}">

  <div>
    <label>Nombre:</label>
    <input type="text" name="nombre" th:value="${personaje.nombre}" required>
  </div>

  <div>
    <label>Ciudad:</label>
    <select name="ciudad">
      <option value="Piltover" th:selected="${personaje.ciudad == 'Piltover'}">Piltover</option>
      <option value="Zaun" th:selected="${personaje.ciudad == 'Zaun'}">Zaun</option>
    </select>
  </div>

  <div>
    <label>Tipo:</label>
    <select name="tipoPersonaje" id="tipoPersonaje" onchange="mostrarCampos()">
      <option value="DEFENSOR" th:selected="${personaje instanceof T(udla.edu.programacion.Defensor)}">Defensor</option>
      <option value="REBELDE" th:selected="${personaje instanceof T(udla.edu.programacion.Rebelde)}">Rebelde</option>
    </select>
  </div>

  <div id="defensorFields" th:style="${personaje instanceof T(udla.edu.programacion.Defensor)} ? 'display:block' : 'display:none'">
    <label>Rango:</label>
    <input type="text" name="rango" th:value="${personaje instanceof T(udla.edu.programacion.Defensor)} ? ${personaje.rango} : ''">
  </div>

  <div id="rebeldeFields" th:style="${personaje instanceof T(udla.edu.programacion.Rebelde)} ? 'display:block' : 'display:none'">
    <label>Motivo:</label>
    <input type="text" name="motivo" th:value="${personaje instanceof T(udla.edu.programacion.Rebelde)} ? ${personaje.motivo} : ''">
  </div>

  <button type="submit">Guardar</button>
  <a href="/personajes">Cancelar</a>
</form>

<script>
  function mostrarCampos() {
      const tipo = document.getElementById('tipoPersonaje').value;
      document.getElementById('defensorFields').style.display = tipo === 'DEFENSOR' ? 'block' : 'none';
      document.getElementById('rebeldeFields').style.display = tipo === 'REBELDE' ? 'block' : 'none';
  }
</script>
</body>
</html>